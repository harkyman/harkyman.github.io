<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Sixtyfour&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
	<style>
		.bodycontainer {
		  position: absolute;
		  left: 10%;
		  top: 50%;
		  width: 80%;
		}

		#btnRefresh {
			color: transparent;
			text-shadow: 0 0 0 #e5ffc1;
			font-size: 15pt;
		}

		#btnRefresh:hover {
			cursor: pointer;
		}

		
		td {
			font-family: "Sixtyfour", sans-serif;
		  font-optical-sizing: auto;
		  font-weight: 400;
		  font-style: normal;
		  font-variation-settings:
			"BLED" 0,
			"SCAN" -25,
			"XELA" 0,
			"YELA" 0;
			color: #e5ffc1;
		  font-size: 6pt;
			padding-bottom: 0.5%;
		}


		
		body {
			background-color: #5d635d;
		}

		#glassoverlay {
			position: absolute;
			width: 100%;
			height: 100%;
			top:0;
			left:0;
			  /* The image used */
			  background-image: url("overlay.png");

			  /* Full height */
			  height: 100%;

			  /* Center and scale the image nicely */
			  background-position: center;
			  background-repeat: no-repeat;
			  background-size: cover;
		}

		#stationoverlay {
			position: absolute;
			width: 100%;
			height: 100%;
			top:0;
			left:0;
			  /* The image used */
			  background-image: url("https://harkyman.github.io/stationimage.png");

			  /* Full height */
			  height: 100%;

			  /* Center and scale the image nicely */
			  background-position-y: 30%;
background-position-x: 49%;
			  background-repeat: no-repeat;
			  background-size: 243%;
		}

		@media only screen and (min-width: 800px) {
		  td {
			font-size: 135%;
		  }

			.bodycontainer {
				top: 28%;
			}

		  #stationoverlay {
			background-position-y: 49%;
			}
		}
	</style>
    <title>Zurich - Feldeggstrasse Departures</title>
	<script>
		function makeList(x) {
				for (y=0;y<7;y++) {
				  var display = [];
				  var times = [];
				  var delays = [];
					var boardtime = Math.round((new Date(x["stationboard"][y]["stop"]["departure"]) - new Date())/60000);
					var delay = x["stationboard"][y]["stop"]["delay"];
				  //display.push(x["stationboard"][y]["category"]); 
				  display.push(x["stationboard"][y]["number"]); 
				  display.push(" ");
				  display.push(x["stationboard"][y]["to"].split(",")[0]);
					if ((boardtime + delay) == 0) {
						times.push("ðŸšŠ");
						$("#ti" + y).css("color", "transparent").css("text-shadow","0 0 0 #e5ffc1");
					} else {
						times.push(boardtime);
						times.push("'");
					}
				  if (delay) {
					delays.push("(+"); 
					delays.push(delay);
					delays.push(")");
				  } else {
					delays.push();
				  }
				  $("#di" + y).html( display.join(""));
				  $("#de" + y).html( delays.join(""));
				  $("#ti" + y).html( times.join(""));

					if ((boardtime + delay) < 0) {
						$("#di" + y).css("color","rgba(229,255,193,0.5)");
						$("#de" + y).css("color","rgba(229,255,193,0.5)");
						$("#ti" + y).css("color","rgba(229,255,193,0.5)");
					}
				}
			}
				
		document.addEventListener('DOMContentLoaded', function() {
			fetch('https://transport.opendata.ch/v1/stationboard?id=8576197&limit=7', {
			   headers: {
				  'Accept': 'application/json'
			   }
			})
			   .then(response => response.text())
			   .then(text => makeList(JSON.parse(text)));
		}, false);
		

	</script>
  </head>
  <body>
<div id="stationoverlay"></div>
	<div class="bodycontainer">
		<div><table id="board" style="width: 100%;">
			<tr><td id="di0"></td><td id="de0"></td><td id="ti0" style="text-align: right"></td></tr>
			<tr><td id="di1"></td><td id="de1"></td><td id="ti1" style="text-align: right"></td></tr>
			<tr><td id="di2"></td><td id="de2"></td><td id="ti2" style="text-align: right"></td></tr>
			<tr><td id="di3"></td><td id="de3"></td><td id="ti3" style="text-align: right"></td></tr>
			<tr><td id="di4"></td><td id="de4"></td><td id="ti4" style="text-align: right"></td></tr>
			<tr><td id="di5"></td><td id="de5"></td><td id="ti5" style="text-align: right"></td></tr>
			<tr><td id="di6"></td><td id="de6"></td><td id="ti6" style="text-align: right"></td></tr>
		</table></div>
		<div style="text-align: right; display: none;"><span id="btnRefresh">ðŸšŠ</span></div>
	</div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script type="text/javascript">
		$(function()
		{		
			$("#btnRefresh").click(function() { location.reload(); } );
			
			
		});
	</script>
  </body>
</html>
